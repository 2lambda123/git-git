GIT v1.5.4 Release Notes
========================

Removal
-------

 * "but svnimport" was removed in favor of "but svn".  It is still there
   in the source tree (contrib/examples) but unsupported.

 * As but-cummit and but-status have been rewritten, "but runstatus"
   helper script lost all its users and has been removed.


Temporarily disabled
--------------------

 * "but http-push" is known not to work well with cURL library older
   than 7.16, and we had reports of repository corruption.  It is
   disabled on such platforms for now.  Unfortunately, 1.5.3.8 shares
   the same issue.  In other words, this does not mean you will be
   fine if you stick to an older but release.  For now, please do not
   use http-push from older but with cURL older than 7.16 if you
   value your data. A proper fix will hopefully materialize in
   later versions.


Deprecation notices
-------------------

 * From v1.6.0, but will by default install dashed form of commands
   (e.g. "but-cummit") outside of users' normal $PATH, and will install
   only selected commands ("but" itself, and "butk") in $PATH.  This
   implies:

   - Using dashed forms of but commands (e.g. "but-cummit") from the
     command line has been informally deprecated since early 2006, but
     now it officially is, and will be removed in the future.  Use
     dash-less forms (e.g. "but cummit") instead.

   - Using dashed forms from your scripts, without first prepending the
     return value from "but --exec-path" to the scripts' PATH, has been
     informally deprecated since early 2006, but now it officially is.

   - Use of dashed forms with "PATH=$(but --exec-path):$PATH; export
     PATH" early in your script is not deprecated with this change.

   Users are strongly encouraged to adjust their habits and scripts now
   to prepare for this change.

 * The post-receive hook was introduced in March 2007 to supersede
   the post-update hook, primarily to overcome the command line length
   limitation of the latter.  Use of post-update hook will be deprecated
   in future versions of but, starting from v1.6.0.

 * "but lost-found" was deprecated in favor of "but fsck"'s --lost-found
   option, and will be removed in the future.

 * "but peek-remote" is deprecated, as "but ls-remote" was written in C
   and works for all transports; "but peek-remote" will be removed in
   the future.

 * "but repo-config" which was an old name for "but config" command
   has been supported without being advertised for a long time.  The
   next feature release will remove it.

 * From v1.6.0, the repack.usedeltabaseoffset config option will default
   to true, which will give denser packfiles (i.e. more efficient storage).
   The downside is that but older than version 1.4.4 will not be able
   to directly use a repository packed using this setting.

 * From v1.6.0, the pack.indexversion config option will default to 2,
   which is slightly more efficient, and makes repacking more immune to
   data corruptions.  Git older than version 1.5.2 may revert to version 1
   of the pack index with a manual "but index-pack" to be able to directly
   access corresponding pack files.


Updates since v1.5.3
--------------------

 * Comes with much improved butk, with i18n.

 * Comes with but-gui 0.9.2 with i18n.

 * butk is now merged as a subdirectory of but.but project, in
   preparation for its i18n.

 * progress displays from many commands are a lot nicer to the eye.
   Transfer commands show throughput data.

 * many commands that pay attention to per-directory .butignore now do
   so lazily, which makes the usual case go much faster.

 * Output processing for '--pretty=format:<user format>' has been
   optimized.

 * Rename detection of diff family while detecting exact matches has
   been greatly optimized.

 * Rename detection of diff family tries to make more natural looking
   pairing.  Earlier, if multiple identical rename sources were
   found in the preimage, the source used was picked pretty much at random.

 * Value "true" for color.diff and color.status configuration used to
   mean "always" (even when the output is not going to a terminal).
   This has been corrected to mean the same thing as "auto".

 * "but diff" Porcelain now respects diff.external configuration, which
   is another way to specify GIT_EXTERNAL_DIFF.

 * "but diff" can be told to use different prefixes other than
   "a/" and "b/" e.g. "but diff --src-prefix=l/ --dst-prefix=k/".

 * "but diff" sometimes did not quote paths with funny
   characters properly.

 * "but log" (and any revision traversal commands) misbehaved
   when --diff-filter is given but was not asked to actually
   produce diff.

 * HTTP proxy can be specified per remote repository using
   remote.*.httpproxy configuration, or global http.proxy configuration
   variable.

 * Various Perforce importer updates.

 * Example update and post-receive hooks have been improved.

 * Any command that wants to take a cummit object name can now use
   ":/string" syntax to name a cummit.

 * "but reset" is now built-in and its output can be squelched with -q.

 * "but reset --hard" does not make any sense in a bare
   repository, but did not error out; fixed.

 * "but send-email" can optionally talk over ssmtp and use SMTP-AUTH.

 * "but rebase" learned --whitespace option.

 * In "but rebase", when you decide not to replay a particular change
   after the command stopped with a conflict, you can say "but rebase
   --skip" without first running "but reset --hard", as the command now
   runs it for you.

 * "but rebase --interactive" mode can now work on detached HEAD.

 * Other minor to serious bugs in "but rebase -i" have been fixed.

 * "but rebase" now detaches head during its operation, so after a
   successful "but rebase" operation, the reflog entry branch@{1} for
   the current branch points at the cummit before the rebase was
   started.

 * "but rebase -i" also triggers rerere to help your repeated merges.

 * "but merge" can call the "post-merge" hook.

 * "but pack-objects" can optionally run deltification with multiple
   threads.

 * "but archive" can optionally substitute keywords in files marked with
   export-subst attribute.

 * "but cherry-pick" made a misguided attempt to repeat the original
   command line in the generated log message, when told to cherry-pick a
   cummit by naming a tag that points at it.  It does not anymore.

 * "but for-each-ref" learned %(xxxdate:<date-format>) syntax to show the
   various date fields in different formats.

 * "but gc --auto" is a low-impact way to automatically run a variant of
   "but repack" that does not lose unreferenced objects (read: safer
   than the usual one) after the user accumulates too many loose
   objects.

 * "but clean" has been rewritten in C.

 * You need to explicitly set clean.requireForce to "false" to allow
   "but clean" without -f to do any damage (lack of the configuration
   variable used to mean "do not require -f option to lose untracked
   files", but we now use the safer default).

 * The kinds of whitespace errors "but diff" and "but apply" notice (and
   fix) can be controlled via 'core.whitespace' configuration variable
   and 'whitespace' attribute in .butattributes file.

 * "but push" learned --dry-run option to show what would happen if a
   push is run.

 * "but push" does not update a tracking ref on the local side when the
   remote refused to update the corresponding ref.

 * "but push" learned --mirror option.  This is to push the local refs
   one-to-one to the remote, and deletes refs from the remote that do
   not exist anymore in the repository on the pushing side.

 * "but push" can remove a corrupt ref at the remote site with the usual
   ":ref" refspec.

 * "but remote" knows --mirror mode.  This is to set up configuration to
   push into a remote repository to store local branch heads to the same
   branch on the remote side, and remove branch heads locally removed
   from local repository at the same time.  Suitable for pushing into a
   back-up repository.

 * "but remote" learned "rm" subcommand.

 * "but cvsserver" can be run via "but shell".  Also, "cvs" is
   recognized as a synonym for "but cvsserver", so that CVS users
   can be switched to but just by changing their login shell.

 * "but cvsserver" acts more like receive-pack by running post-receive
   and post-update hooks.

 * "but am" and "but rebase" are far less verbose.

 * "but pull" learned to pass --[no-]ff option to underlying "but
   merge".

 * "but pull --rebase" is a different way to integrate what you fetched
   into your current branch.

 * "but fast-export" produces data-stream that can be fed to fast-import
   to reproduce the history recorded in a but repository.

 * "but add -i" takes pathspecs to limit the set of files to work on.

 * "but add -p" is a short-hand to go directly to the selective patch
   subcommand in the interactive command loop and to exit when done.

 * "but add -i" UI has been colorized.  The interactive prompt
   and menu can be colored by setting color.interactive
   configuration.  The diff output (including the hunk picker)
   are colored with color.diff configuration.

 * "but cummit --allow-empty" allows you to create a single-parent
   cummit that records the same tree as its parent, overriding the usual
   safety valve.

 * "but cummit --amend" can amend a merge that does not change the tree
   from its first parent.

 * "but cummit" used to unconditionally strip comment lines that
   began with '#' and removed excess blank lines.  This behavior has
   been made configurable.

 * "but cummit" has been rewritten in C.

 * "but stash random-text" does not create a new stash anymore.  It was
   a UI mistake.  Use "but stash save random-text", or "but stash"
   (without extra args) for that.

 * "but stash clear extra-text" does not clear the whole stash
   anymore.  It is tempting to expect "but stash clear stash@{2}"
   to drop only a single named stash entry, and it is rude to
   discard everything when that is asked (but not provided).

 * "but prune --expire <time>" can exempt young loose objects from
   getting pruned.

 * "but branch --contains <cummit>" can list branches that are
   descendants of a given cummit.

 * "but log" learned --early-output option to help interactive GUI
   implementations.

 * "but bisect" learned "skip" action to mark untestable cummits.

 * "but bisect visualize" learned a shorter synonym "but bisect view".

 * "but bisect visualize" runs "but log" in a non-windowed
   environments.  It also can be told what command to run (e.g. "but
   bisect visualize tig").

 * "but format-patch" learned "format.numbered" configuration variable
   to automatically turn --numbered option on when more than one cummits
   are formatted.

 * "but ls-files" learned "--exclude-standard" to use the canned set of
   exclude files.

 * "but tag -a -f existing" begins the editor session using the existing
   annotation message.

 * "but tag -m one -m bar" (multiple -m options) behaves similarly to
   "but cummit"; the parameters to -m options are formatted as separate
   paragraphs.

 * The format "but show" outputs an annotated tag has been updated to
   include "Tagger: " and "Date: " lines from the tag itself.  Strictly
   speaking this is a backward incompatible change, but this is a
   reasonable usability fix and people's scripts shouldn't have been
   relying on the exact output from "but show" Porcelain anyway.

 * "but cvsimport" did not notice errors from underlying "cvsps"
   and produced a corrupt import silently.

 * "but cvsexportcummit" learned -w option to specify and switch to the
   CVS working directory.

 * "but checkout" from a subdirectory learned to use "../path" to allow
   checking out a path outside the current directory without cd'ing up.

 * "but checkout" from and to detached HEAD leaves a bit more
   information in the reflog.

 * "but send-email --dry-run" shows full headers for easier diagnosis.

 * "but merge-ours" is now built-in.

 * "but svn" learned "info" and "show-externals" subcommands.

 * "but svn" run from a subdirectory failed to read settings from the
   .but/config.

 * "but svn" learned --use-log-author option, which picks up more
   descriptive name from From: and Signed-off-by: lines in the cummit
   message.

 * "but svn" wasted way too much disk to record revision mappings
   between svn and but; a new representation that is much more compact
   for this information has been introduced to correct this.

 * "but svn" left temporary index files it used without cleaning them
   up; this was corrected.

 * "but status" from a subdirectory now shows relative paths, which
   makes copy-and-pasting for but-checkout/but-add/but-rm easier.  The
   traditional behavior to show the full path relative to the top of
   the work tree can be had by setting status.relativepaths
   configuration variable to false.

 * "but blame" kept text for each annotated revision in core needlessly;
   this has been corrected.

 * "but shortlog" learned to default to HEAD when the standard input is
   a terminal and the user did not give any revision parameter.

 * "but shortlog" learned "-e" option to show e-mail addresses as well as
   authors' names.

 * "but help" learned "-w" option to show documentation in browsers.

 * In addition there are quite a few internal clean-ups. Notably:

   - many fork/exec have been replaced with run-command API,
     brought from the msysbut effort.

   - introduction and more use of the option parser API.

   - enhancement and more use of the strbuf API.

 * Makefile tweaks to support HP-UX is in.

Fixes since v1.5.3
------------------

All of the fixes in v1.5.3 maintenance series are included in
this release, unless otherwise noted.

These fixes are only in v1.5.4 and not backported to v1.5.3 maintenance
series.

 * The way "but diff --check" behaves is much more consistent with the way
   "but apply --whitespace=warn" works.

 * "but svn" talking with the SVN over HTTP will correctly quote branch
   and project names.

 * "but config" did not work correctly on platforms that define
   REG_NOMATCH to an even number.

 * Recent versions of AsciiDoc 8 has a change to break our
   documentation; a workaround has been implemented.

 * "but diff --color-words" colored context lines in a wrong color.
