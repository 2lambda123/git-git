GIT v1.6.5 Release Notes
========================

In but 1.7.0, which was planned to be the release after 1.6.5, "but
push" into a branch that is currently checked out will be refused by
default.

You can choose what should happen upon such a push by setting the
configuration variable receive.denyCurrentBranch in the receiving
repository.

Also, "but push $there :$killed" to delete the branch $killed in a remote
repository $there, when $killed branch is the current branch pointed at by
its HEAD, will be refused by default.

You can choose what should happen upon such a push by setting the
configuration variable receive.denyDeleteCurrent in the receiving
repository.

To ease the transition plan, the receiving repository of such a
push running this release will issue a big warning when the
configuration variable is missing.  Please refer to:

  http://but.or.cz/butwiki/GitFaq#non-bare
  https://lore.kernel.org/but/7vbptlsuyv.fsf@butster.siamese.dyndns.org/

for more details on the reason why this change is needed and the
transition plan.

Updates since v1.6.4
--------------------

(subsystems)

 * various updates to butk, but-svn and butweb.

(portability)

 * more improvements on mingw port.

 * mingw will also give FRSX as the default value for the LESS
   environment variable when the user does not have one.

 * initial support to compile but on Windows with MSVC.

(performance)

 * On major platforms, the system can be compiled to use with Linus's
   block-sha1 implementation of the SHA-1 hash algorithm, which
   outperforms the default fallback implementation we borrowed from
   Mozilla.

 * Unnecessary inefficiency in deepening of a shallow repository has
   been removed.

 * "but clone" does not grab objects that it does not need (i.e.
   referenced only from refs outside refs/heads and refs/tags
   hierarchy) anymore.

 * The "but" main binary used to link with libcurl, which then dragged
   in a large number of external libraries.  When using basic plumbing
   commands in scripts, this unnecessarily slowed things down.  We now
   implement http/https/ftp transfer as a separate executable as we
   used to.

 * "but clone" run locally hardlinks or copies the files in .but/ to
   newly created repository.  It used to give new mtime to copied files,
   but this delayed garbage collection to trigger unnecessarily in the
   cloned repository.  We now preserve mtime for these files to avoid
   this issue.

(usability, bells and whistles)

 * Human writable date format to various options, e.g. --since=yesterday,
   master@{2000.09.17}, are taught to infer some omitted input properly.

 * A few programs gave verbose "advice" messages to help uninitiated
   people when issuing error messages.  An infrastructure to allow
   users to squelch them has been introduced, and a few such messages
   can be silenced now.

 * refs/replace/ hierarchy is designed to be usable as a replacement
   of the "grafts" mechanism, with the added advantage that it can be
   transferred across repositories.

 * "but am" learned to optionally ignore whitespace differences.

 * "but am" handles input e-mail files that has CRLF line endings sensibly.

 * "but am" learned "--scissors" option to allow you to discard early part
   of an incoming e-mail.

 * "but archive -o output.zip" works without being told what format to
   use with an explicit "--format=zip".option.

 * "but checkout", "but reset" and "but stash" learned to pick and
   choose to use selected changes you made, similar to "but add -p".

 * "but clone" learned a "-b" option to pick a HEAD to check out
   different from the remote's default branch.

 * "but clone" learned --recursive option.

 * "but clone" from a local repository on a different filesystem used to
   copy individual object files without preserving the old timestamp, giving
   them extra lifetime in the new repository until they gc'ed.

 * "but cummit --dry-run $args" is a new recommended way to ask "what would
   happen if I try to cummit with these arguments."

 * "but cummit --dry-run" and "but status" shows conflicted paths in a
   separate section to make them easier to spot during a merge.

 * "but cvsimport" now supports password-protected pserver access even
   when the password is not taken from ~/.cvspass file.

 * "but fast-export" learned --no-data option that can be useful when
   reordering cummits and trees without touching the contents of
   blobs.

 * "but fast-import" has a pair of new front-end in contrib/ area.

 * "but init" learned to mkdir/chdir into a directory when given an
   extra argument (i.e. "but init this").

 * "but instaweb" optionally can use mongoose as the web server.

 * "but log --decorate" can optionally be told with --decorate=full to
   give the reference name in full.

 * "but merge" issued an unnecessarily scary message when it detected
   that the merge may have to touch the path that the user has local
   uncummitted changes to. The message has been reworded to make it
   clear that the command aborted, without doing any harm.

 * "but push" can be told to be --quiet.

 * "but push" pays attention to url.$base.pushInsteadOf and uses a URL
   that is derived from the URL used for fetching.

 * informational output from "but reset" that lists the locally modified
   paths is made consistent with that of "but checkout $another_branch".

 * "but submodule" learned to give submodule name to scripts run with
   "foreach" subcommand.

 * various subcommands to "but submodule" learned --recursive option.

 * "but submodule summary" learned --files option to compare the work
   tree vs the cummit bound at submodule path, instead of comparing
   the index.

 * "but upload-pack", which is the server side support for "but clone" and
   "but fetch", can call a new post-upload-pack hook for statistics purposes.

(developers)

 * With GIT_TEST_OPTS="--root=/p/a/t/h", tests can be run outside the
   source directory; using tmpfs may give faster turnaround.

 * With NO_PERL_MAKEMAKER set, DESTDIR= is now honoured, so you can
   build for one location, and install into another location to tar it
   up.

Fixes since v1.6.4
------------------

All of the fixes in v1.6.4.X maintenance series are included in this
release, unless otherwise noted.
